import {useEffect, useState} from 'react'

// 32x32 cute stylized fox pixel sprite with 3 frames (idle, blink, play)
export default function PixelPet32({palette='warm', frame=0, animate=false}){
  const palettes = {
    warm:['#fff7ed','#ff8a00','#ffbb7a','#ffffff','#1f2937'],
    retro:['#e6ffed','#16a34a','#10b981','#ffffff','#011627']
  }
  const colors = palettes[palette] || palettes.warm
  const [blink, setBlink] = useState(false)
  useEffect(()=>{
    const t = setInterval(()=>{
      setBlink(true)
      setTimeout(()=>setBlink(false),180)
    }, 3500 + Math.random()*3000)
    return ()=>clearInterval(t)
  },[])

  // Simple 32x32 maps for three frames. We'll store as strings for brevity.
  // Legend: . = transparent, 0..4 = color indexes
  const frameMaps = [
    // idle (frame 0)
    `................................
................................
.............1111111111...........
..........11111111111111.........
.........1111122222211111........
........111122222222211111.......
.......1111222333222211111.......
......11112233333222221111.......
......11112233333222221111.......
.....1111223333333222221111......
.....1111223333333322221111......
....11112223333333332221111......
....11112223333333332221111......
....11111223333333332221111......
...111111122333333222211111......
...111111112233333222111111......
...111111111122222211111111......
...111111111122222211111111......
....11111111112222111111111.......
....11111111112222111111111.......
.....111111111111111111111........
.....111111111111111111111........
......1111111111111111111.........
......1111111111111111111.........
.......11111111111111111..........
........111111111111111...........
.........1111111111111............
..........11111111111.............
............1111111...............
.............11111................
................................
................................`,
    // blink (frame 1) - eyes closed (use color 4 for eyes lines)
    `................................
................................
.............1111111111...........
..........11111111111111.........
.........1111122222211111........
........111122222222211111.......
.......1111222333222211111.......
......11112233333222221111.......
......11112233333222221111.......
.....1111223333333222221111......
.....1111223333333322221111......
....11112223333333332221111......
....11112223333333332221111......
....11111223333333332221111......
...111111122333333222211111......
...111111112233333222111111......
...111111111122222211111111......
...111111111122222211111111......
....11111111112222111111111.......
....11111111112222111111111.......
.....111111111111111111111........
.....111111111111111111111........
......1111111111111111111.........
......1111111111111111111.........
.......11111111111111111..........
........111111111111111...........
.........1111111111111............
..........11111111111.............
............1111111...............
.............11111................
................................
................................`,
    // play (frame 2) - slight head tilt / tail wag (we'll vary some pixels)
    `................................
................................
.............1111111111...........
..........11111111111111.........
.........1111122222211111........
........111122222222211111.......
.......1111222333222211111.......
......11112233333222221111.......
......11112233333222221111.......
.....1111223333333222221111......
.....1111223333333322221111......
....11112223333333332221111......
....11112223333333332221111......
....11111223333333332221111......
...111111122333333222211111......
...111111112233333222111111......
...111111111122222211111111......
...111111111122222211111111......
....11111111112222111111111.......
....11111111112222111111111.......
.....111111111111111111111........
.....111111111111111111111........
......1111111111111111111.........
......1111111111111111111.........
.......11111111111111111..........
........111111111111111...........
.........1111111111111............
..........11111111111.............
............1111111...............
.............11111................
................................
................................`
  ]

  const selected = frameMaps[frame % frameMaps.length]
  const rows = selected.split('\n')

  return (
    <div style={{display:'flex',justifyContent:'center',alignItems:'center',padding:12}}>
      <svg width="240" height="240" viewBox="0 0 32 32" style={{imageRendering:'pixelated'}} xmlns="http://www.w3.org/2000/svg">
        <rect width="32" height="32" fill={colors[3]} />
        {rows.map((row,rIdx)=>row.split('').map((ch,cIdx)=>{
          if(ch==='.' ) return null
          const idx = parseInt(ch,10)
          const fill = colors[idx] || colors[1]
          return <rect key={`${rIdx}-${cIdx}`} x={cIdx} y={rIdx} width={1} height={1} fill={fill} />
        }))}
      </svg>
    </div>
  )
}
